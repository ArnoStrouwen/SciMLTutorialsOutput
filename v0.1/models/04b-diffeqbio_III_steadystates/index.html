<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DiffEqBiological Tutorial III: Steady-States and Bifurcations · The SciML Tutorials</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://tutorials.sciml.ai/stable/models/04b-diffeqbio_III_steadystates/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">The SciML Tutorials</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SciMLTutorials.jl: Tutorials for Scientific Machine Learning (SciML), Equation Solvers, and AI for Science</a></li><li><span class="tocitem">DiffEqUncertainty</span><ul><li><a class="tocitem" href="../../DiffEqUncertainty/01-expectation_introduction/">An Intro to Expectations via DiffEqUncertainty.jl</a></li><li><a class="tocitem" href="../../DiffEqUncertainty/02-AD_and_optimization/">Optimization Under Uncertainty with DiffEqUncertainty.jl</a></li></ul></li><li><span class="tocitem">advanced</span><ul><li><a class="tocitem" href="../../advanced/01-beeler_reuter/">An Implicit/Explicit CUDA-Accelerated Solver for the 2D Beeler-Reuter Model</a></li><li><a class="tocitem" href="../../advanced/02-advanced_ODE_solving/">Solving Stiff Equations</a></li><li><a class="tocitem" href="../../advanced/03-kolmogorov_equations/">Kolmogorov Backward Equations</a></li><li><a class="tocitem" href="../../advanced/04-diffusion_implicit_heat_equation/">Solving the heat equation with diffusion-implicit time-stepping</a></li></ul></li><li><span class="tocitem">exercises</span><ul><li><a class="tocitem" href="../../exercises/01-workshop_exercises/">SciML Workshop Exercises</a></li><li><a class="tocitem" href="../../exercises/02-workshop_solutions/">SciML Workshop Exercise Solutions</a></li></ul></li><li><span class="tocitem">introduction</span><ul><li><a class="tocitem" href="../../introduction/01-ode_introduction/">An Intro to DifferentialEquations.jl</a></li><li><a class="tocitem" href="../../introduction/02-choosing_algs/">Choosing an ODE Algorithm</a></li><li><a class="tocitem" href="../../introduction/03-optimizing_diffeq_code/">Optimizing DiffEq Code</a></li><li><a class="tocitem" href="../../introduction/04-callbacks_and_events/">Callbacks and Events</a></li><li><a class="tocitem" href="../../introduction/05-formatting_plots/">Formatting Plots</a></li></ul></li><li><span class="tocitem">jumps</span><ul><li><a class="tocitem" href="../../jumps/spatial/">Ilin</a></li></ul></li><li><span class="tocitem">model_inference</span><ul><li><a class="tocitem" href="../../model_inference/01-pendulum_bayesian_inference/">Bayesian Inference on a Pendulum using DiffEqBayes.jl</a></li><li><a class="tocitem" href="../../model_inference/02-monte_carlo_parameter_estim/">Monte Carlo Parameter Estimation From Data</a></li></ul></li><li><span class="tocitem">models</span><ul><li><a class="tocitem" href="../01-classical_physics/">Classical Physics Models</a></li><li><a class="tocitem" href="../02-conditional_dosing/">Conditional Dosing Pharmacometric Example</a></li><li><a class="tocitem" href="../03-diffeqbio_I_introduction/">DiffEqBiological Tutorial I: Introduction</a></li><li><a class="tocitem" href="../04-diffeqbio_II_networkproperties/">DiffEqBiological Tutorial II: Network Properties API</a></li><li class="is-active"><a class="tocitem" href>DiffEqBiological Tutorial III: Steady-States and Bifurcations</a><ul class="internal"><li><a class="tocitem" href="#Getting-Help"><span>Getting Help</span></a></li></ul></li><li><a class="tocitem" href="../05-kepler_problem/">Kepler Problem</a></li><li><a class="tocitem" href="../07-outer_solar_system/">The Outer Solar System</a></li><li><a class="tocitem" href="../08-spiking_neural_systems/">Spiking Neural Systems</a></li></ul></li><li><span class="tocitem">ode_extras</span><ul><li><a class="tocitem" href="../../ode_extras/01-ModelingToolkit/">ModelingToolkit.jl, An IR and Compiler for Scientific Models</a></li><li><a class="tocitem" href="../../ode_extras/02-feagin/">Feagin&#39;s Order 10, 12, and 14 Methods</a></li><li><a class="tocitem" href="../../ode_extras/03-ode_minmax/">Finding Maxima and Minima of DiffEq Solutions</a></li></ul></li><li><span class="tocitem">perturbation</span><ul><li><a class="tocitem" href="../../perturbation/01-perturbation_algebraic/">Mixed Symbolic/Numerical Methods for Perturbation Theory - Algebraic Equations</a></li><li><a class="tocitem" href="../../perturbation/02-perturbation_differential/">Mixed Symbolic/Numerical Methods for Perturbation Theory - Differential Equations</a></li></ul></li><li><span class="tocitem">type_handling</span><ul><li><a class="tocitem" href="../../type_handling/02-uncertainties/">Numbers with Uncertainties</a></li><li><a class="tocitem" href="../../type_handling/03-unitful/">Unit Checked Arithmetic via Unitful.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">models</a></li><li class="is-active"><a href>DiffEqBiological Tutorial III: Steady-States and Bifurcations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DiffEqBiological Tutorial III: Steady-States and Bifurcations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/SciMLTutorialsOutput/blob/main/docs/src/models/04b-diffeqbio_III_steadystates.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DiffEqBiological-Tutorial-III:-Steady-States-and-Bifurcations"><a class="docs-heading-anchor" href="#DiffEqBiological-Tutorial-III:-Steady-States-and-Bifurcations">DiffEqBiological Tutorial III: Steady-States and Bifurcations</a><a id="DiffEqBiological-Tutorial-III:-Steady-States-and-Bifurcations-1"></a><a class="docs-heading-anchor-permalink" href="#DiffEqBiological-Tutorial-III:-Steady-States-and-Bifurcations" title="Permalink"></a></h1><p>Several types of steady state analysis can be performed for networks defined with DiffEqBiological by utilizing homotopy continuation. This allows for finding the steady states and bifurcations within a large class of systems. In this tutorial we&#39;ll go through several examples of using this functionality.</p><p>We start by loading the necessary packages:</p><pre><code class="language-julia hljs">using DiffEqBiological, Plots
gr(); default(fmt = :png);</code></pre><pre><code class="nohighlight hljs">Error: ArgumentError: Package DiffEqBiological not found in current path:
- Run `import Pkg; Pkg.add(&quot;DiffEqBiological&quot;)` to install the DiffEqBiolog
ical package.</code></pre><h3 id="Steady-states-and-stability-of-a-biochemical-reaction-network."><a class="docs-heading-anchor" href="#Steady-states-and-stability-of-a-biochemical-reaction-network.">Steady states and stability of a biochemical reaction network.</a><a id="Steady-states-and-stability-of-a-biochemical-reaction-network.-1"></a><a class="docs-heading-anchor-permalink" href="#Steady-states-and-stability-of-a-biochemical-reaction-network." title="Permalink"></a></h3><p>Bistable switches are well known biological motifs, characterised by the presence of two different stable steady states.</p><pre><code class="language-julia hljs">bistable_switch = @reaction_network begin
    d,    (X,Y) → ∅
    hillR(Y,v1,K1,n1), ∅ → X
    hillR(X,v2,K2,n2), ∅ → Y
end d v1 K1 n1 v2 K2 n2
d = 0.01;
v1 = 1.5; K1 = 30; n1 = 3;
v2 = 1.; K2 = 30; n2 = 3;
bistable_switch_p = [d, v1 ,K1, n1, v2, K2, n2];</code></pre><pre><code class="nohighlight hljs">Error: LoadError: UndefVarError: @reaction_network not defined
in expression starting at /var/lib/buildkite-agent/builds/1-amdci4-julia-cs
ail-mit-edu/julialang/scimltutorials-dot-jl/tutorials/models/04b-diffeqbio_
III_steadystates.jmd:2</code></pre><p>The steady states can be found using the <code>steady_states</code> function (which takes a reaction network and a set of parameter values as input). The stability of these steady states can be found using the <code>stability</code> function.</p><pre><code class="language-julia hljs">ss = steady_states(bistable_switch, bistable_switch_p)</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: steady_states not defined</code></pre><pre><code class="language-julia hljs">stability(ss,bistable_switch, bistable_switch_p)</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: stability not defined</code></pre><p>Since the equilibration methodology is based on homotopy continuation, it is not able to handle systems with non-integer exponents, or non polynomial reaction rates. Neither of the following two systems will work.</p><p>This system contains a non-integer exponent:</p><pre><code class="language-julia hljs">rn1 = @reaction_network begin
    p, ∅ → X
    hill(X,v,K,n), X → ∅
end p v K n
p1 = [1.,2.5,1.5,1.5]
steady_states(rn1,p1)</code></pre><pre><code class="nohighlight hljs">Error: LoadError: UndefVarError: @reaction_network not defined
in expression starting at /var/lib/buildkite-agent/builds/1-amdci4-julia-cs
ail-mit-edu/julialang/scimltutorials-dot-jl/tutorials/models/04b-diffeqbio_
III_steadystates.jmd:2</code></pre><p>This system contains a logarithmic reaction rate:</p><pre><code class="language-julia hljs">rn2 = @reaction_network begin
    p, ∅ → X
    log(X), X → ∅
end p
p2 = [1.]
steady_states(rn2,p2)</code></pre><pre><code class="nohighlight hljs">Error: LoadError: UndefVarError: @reaction_network not defined
in expression starting at /var/lib/buildkite-agent/builds/1-amdci4-julia-cs
ail-mit-edu/julialang/scimltutorials-dot-jl/tutorials/models/04b-diffeqbio_
III_steadystates.jmd:2</code></pre><h3 id="Bifurcation-diagrams-for-biochemical-reaction-networks"><a class="docs-heading-anchor" href="#Bifurcation-diagrams-for-biochemical-reaction-networks">Bifurcation diagrams for biochemical reaction networks</a><a id="Bifurcation-diagrams-for-biochemical-reaction-networks-1"></a><a class="docs-heading-anchor-permalink" href="#Bifurcation-diagrams-for-biochemical-reaction-networks" title="Permalink"></a></h3><p>Bifurcation diagrams illustrate how the steady states of a system depend on one or more parameters. They can be computed with the <code>bifurcations</code> function. It takes the same arguments as <code>steady_states</code>, with the addition of the parameter one wants to vary, and an interval over which to vary it:</p><pre><code class="language-julia hljs">bif = bifurcations(bistable_switch, bistable_switch_p, :v1, (.1,5.))
plot(bif,ylabel=&quot;[X]&quot;,label=&quot;&quot;)
plot!([[],[]],color=[:blue :red],label = [&quot;Stable&quot; &quot;Unstable&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcations not defined</code></pre><p>The values for the second variable in the system can also be displayed, by giving that as an additional input to <code>plot</code> (it is the second argument, directly after the bifurcation diagram object):</p><pre><code class="language-julia hljs">plot(bif,2,ylabel=&quot;[Y]&quot;)
plot!([[],[]],color=[:blue :red],label = [&quot;Stable&quot; &quot;Unstable&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: plot not defined</code></pre><p>The <code>plot</code> function also accepts all other arguments which the Plots.jl <code>plot</code> function accepts.</p><pre><code class="language-julia hljs">bif = bifurcations(bistable_switch, bistable_switch_p,:v1,(.1,10.))
plot(bif,linewidth=1.,title=&quot;A bifurcation diagram&quot;,ylabel=&quot;Steady State concentration&quot;)
plot!([[],[]],color=[:blue :red],label = [&quot;Stable&quot; &quot;Unstable&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcations not defined</code></pre><p>Certain parameters, like <code>n1</code>, cannot be sensibly varied over a continuous interval. Instead, a discrete bifurcation diagram can be calculated with the <code>bifurcation_grid</code> function. Instead of an interval, the last argument is a range of numbers:</p><pre><code class="language-julia hljs">bif = bifurcation_grid(bistable_switch, bistable_switch_p,:n1,1.:5.)
plot(bif)
scatter!([[],[]],color=[:blue :red],label = [&quot;Stable&quot; &quot;Unstable&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcation_grid not defined</code></pre><h3 id="Bifurcation-diagrams-over-two-dimensions"><a class="docs-heading-anchor" href="#Bifurcation-diagrams-over-two-dimensions">Bifurcation diagrams over two dimensions</a><a id="Bifurcation-diagrams-over-two-dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Bifurcation-diagrams-over-two-dimensions" title="Permalink"></a></h3><p>In addition to the bifurcation diagrams illustrated above, where only a single variable is varied, it is also possible to investigate the steady state properties of s system as two different parameters are varied. Due to the nature of the underlying bifurcation algorithm it is not possible to continuously vary both parameters. Instead, a set of discrete values are selected for the first parameter, and a continuous interval for the second. Next, for each discrete value of the first parameter, a normal bifurcation diagram is created over the interval given for the second parameter.</p><pre><code class="language-julia hljs">bif = bifurcation_grid_diagram(bistable_switch, bistable_switch_p,:n1,0.:4.,:v1,(.1,5.))
plot(bif)
plot!([[],[]],color=[:blue :red],label = [&quot;Stable&quot; &quot;Unstable&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcation_grid_diagram not defined</code></pre><p>In the single variable case we could use a <code>bifurcation_grid</code> to investigate the behavior of a parameter which could only attain discrete values. In the same way, if we are interested in two parameters, both of which require integer values, we can use <code>bifrucation_grid_2d</code>. In our case, this is required if we want to vary both the parameters <code>n1</code> and <code>n2</code>:</p><pre><code class="language-julia hljs">bif = bifurcation_grid_2d(bistable_switch, bistable_switch_p,:n1,1.:3.,:n2,1.:10.)
plot(bif)
scatter!([[],[]],color=[:blue :red],label = [&quot;Stable&quot; &quot;Unstable&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcation_grid_2d not defined</code></pre><h3 id="The-Brusselator"><a class="docs-heading-anchor" href="#The-Brusselator">The Brusselator</a><a id="The-Brusselator-1"></a><a class="docs-heading-anchor-permalink" href="#The-Brusselator" title="Permalink"></a></h3><p>The Brusselator is a well know reaction network, which may or may not oscillate, depending on parameter values.</p><pre><code class="language-julia hljs">brusselator = @reaction_network begin
    A, ∅ → X
    1, 2X + Y → 3X
    B, X → Y
    1, X → ∅
end A B;
A = 0.5; B = 4.;
brusselator_p = [A, B];</code></pre><pre><code class="nohighlight hljs">Error: LoadError: UndefVarError: @reaction_network not defined
in expression starting at /var/lib/buildkite-agent/builds/1-amdci4-julia-cs
ail-mit-edu/julialang/scimltutorials-dot-jl/tutorials/models/04b-diffeqbio_
III_steadystates.jmd:2</code></pre><p>The system has only one steady state, for <span>$(X,Y)=(A,B/A)$</span> This fixed point becomes unstable when <span>$B &gt; 1+A^2$</span>, leading to oscillations. Bifurcation diagrams can be used to determine the system&#39;s stability, and hence look for where oscillations might appear in the Brusselator:</p><pre><code class="language-julia hljs">bif = bifurcations(brusselator,brusselator_p,:B,(0.1,2.5))
plot(bif,2)
plot!([[],[],[],[]],color=[:blue :cyan :orange :red],label = [&quot;Stable Real&quot; &quot;Stable Complex&quot; &quot;Unstable Complex&quot; &quot;Unstable Real&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcations not defined</code></pre><p>Here red and yellow colors label unstable steady-states, while blue and cyan label stable steady-states. (In addition, yellow and cyan correspond to points where at least one eigenvalue of the Jacobian is imaginary, while red and blue correspond to points with real-valued eigenvalues.)</p><p>Given <code>A=0.5</code>, the point at which the system should become unstable is <code>B=1.25</code>. We can confirm this in the bifurcation diagram.</p><p>We can also investigate the behavior when we vary both parameters of the system:</p><pre><code class="language-julia hljs">bif = bifurcation_grid_diagram(brusselator,brusselator_p,:B,0.5:0.02:5.0,:A,(0.2,5.0))
plot(bif)
plot!([[],[],[],[]],color=[:blue :cyan :orange :red],label = [&quot;Stable Real&quot; &quot;Stable Complex&quot; &quot;Unstable Complex&quot; &quot;Unstable Real&quot;])</code></pre><pre><code class="nohighlight hljs">Error: UndefVarError: bifurcation_grid_diagram not defined</code></pre><hr/><h2 id="Getting-Help"><a class="docs-heading-anchor" href="#Getting-Help">Getting Help</a><a id="Getting-Help-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Help" title="Permalink"></a></h2><p>Have a question related to DiffEqBiological or this tutorial? Feel free to ask in the DifferentialEquations.jl <a href="https://gitter.im/JuliaDiffEq/Lobby">Gitter</a>. If you think you&#39;ve found a bug in DiffEqBiological, or would like to request/discuss new functionality, feel free to open an issue on <a href="https://github.com/JuliaDiffEq/DiffEqBiological.jl">Github</a> (but please check there is no related issue already open). If you&#39;ve found a bug in this tutorial, or have a suggestion, feel free to open an issue on the <a href="https://github.com/JuliaDiffEq/SciMLTutorials.jl">SciMLTutorials Github site</a>. Or, submit a pull request to SciMLTutorials updating the tutorial!</p><hr/><pre><code class="nohighlight hljs">Error: MethodError: no method matching tutorial_footer(::String, ::String; 
remove_homedir=true)
Closest candidates are:
  tutorial_footer(::Any, ::Any) at /var/lib/buildkite-agent/builds/1-amdci4
-julia-csail-mit-edu/julialang/scimltutorials-dot-jl/src/SciMLTutorials.jl:
79 got unsupported keyword argument &quot;remove_homedir&quot;
  tutorial_footer(::Any) at /var/lib/buildkite-agent/builds/1-amdci4-julia-
csail-mit-edu/julialang/scimltutorials-dot-jl/src/SciMLTutorials.jl:79 got 
unsupported keyword argument &quot;remove_homedir&quot;</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../04-diffeqbio_II_networkproperties/">« DiffEqBiological Tutorial II: Network Properties API</a><a class="docs-footer-nextpage" href="../05-kepler_problem/">Kepler Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 13 August 2022 04:28">Saturday 13 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
