<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Formatting Plots · The SciML Tutorials</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://tutorials.sciml.ai/stable/introduction/05-formatting_plots/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">The SciML Tutorials</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SciMLTutorials.jl: Tutorials for Scientific Machine Learning (SciML), Equation Solvers, and AI for Science</a></li><li><span class="tocitem">DiffEqUncertainty</span><ul><li><a class="tocitem" href="../../DiffEqUncertainty/01-expectation_introduction/">An Intro to Expectations via DiffEqUncertainty.jl</a></li><li><a class="tocitem" href="../../DiffEqUncertainty/02-AD_and_optimization/">Optimization Under Uncertainty with DiffEqUncertainty.jl</a></li></ul></li><li><span class="tocitem">advanced</span><ul><li><a class="tocitem" href="../../advanced/01-beeler_reuter/">An Implicit/Explicit CUDA-Accelerated Solver for the 2D Beeler-Reuter Model</a></li><li><a class="tocitem" href="../../advanced/02-advanced_ODE_solving/">Solving Stiff Equations</a></li><li><a class="tocitem" href="../../advanced/03-kolmogorov_equations/">Kolmogorov Backward Equations</a></li><li><a class="tocitem" href="../../advanced/04-diffusion_implicit_heat_equation/">Solving the heat equation with diffusion-implicit time-stepping</a></li></ul></li><li><span class="tocitem">exercises</span><ul><li><a class="tocitem" href="../../exercises/01-workshop_exercises/">SciML Workshop Exercises</a></li><li><a class="tocitem" href="../../exercises/02-workshop_solutions/">SciML Workshop Exercise Solutions</a></li></ul></li><li><span class="tocitem">introduction</span><ul><li><a class="tocitem" href="../01-ode_introduction/">An Intro to DifferentialEquations.jl</a></li><li><a class="tocitem" href="../02-choosing_algs/">Choosing an ODE Algorithm</a></li><li><a class="tocitem" href="../03-optimizing_diffeq_code/">Optimizing DiffEq Code</a></li><li><a class="tocitem" href="../04-callbacks_and_events/">Callbacks and Events</a></li><li class="is-active"><a class="tocitem" href>Formatting Plots</a><ul class="internal"><li><a class="tocitem" href="#Appendix"><span>Appendix</span></a></li></ul></li></ul></li><li><span class="tocitem">jumps</span><ul><li><a class="tocitem" href="../../jumps/spatial/">Ilin</a></li></ul></li><li><span class="tocitem">model_inference</span><ul><li><a class="tocitem" href="../../model_inference/01-pendulum_bayesian_inference/">Bayesian Inference on a Pendulum using DiffEqBayes.jl</a></li><li><a class="tocitem" href="../../model_inference/02-monte_carlo_parameter_estim/">Monte Carlo Parameter Estimation From Data</a></li></ul></li><li><span class="tocitem">models</span><ul><li><a class="tocitem" href="../../models/01-classical_physics/">Classical Physics Models</a></li><li><a class="tocitem" href="../../models/02-conditional_dosing/">Conditional Dosing Pharmacometric Example</a></li><li><a class="tocitem" href="../../models/03-diffeqbio_I_introduction/">DiffEqBiological Tutorial I: Introduction</a></li><li><a class="tocitem" href="../../models/04-diffeqbio_II_networkproperties/">DiffEqBiological Tutorial II: Network Properties API</a></li><li><a class="tocitem" href="../../models/04b-diffeqbio_III_steadystates/">DiffEqBiological Tutorial III: Steady-States and Bifurcations</a></li><li><a class="tocitem" href="../../models/05-kepler_problem/">Kepler Problem</a></li><li><a class="tocitem" href="../../models/07-outer_solar_system/">The Outer Solar System</a></li><li><a class="tocitem" href="../../models/08-spiking_neural_systems/">Spiking Neural Systems</a></li></ul></li><li><span class="tocitem">ode_extras</span><ul><li><a class="tocitem" href="../../ode_extras/01-ModelingToolkit/">ModelingToolkit.jl, An IR and Compiler for Scientific Models</a></li><li><a class="tocitem" href="../../ode_extras/02-feagin/">Feagin&#39;s Order 10, 12, and 14 Methods</a></li><li><a class="tocitem" href="../../ode_extras/03-ode_minmax/">Finding Maxima and Minima of DiffEq Solutions</a></li></ul></li><li><span class="tocitem">perturbation</span><ul><li><a class="tocitem" href="../../perturbation/01-perturbation_algebraic/">Mixed Symbolic/Numerical Methods for Perturbation Theory - Algebraic Equations</a></li><li><a class="tocitem" href="../../perturbation/02-perturbation_differential/">Mixed Symbolic/Numerical Methods for Perturbation Theory - Differential Equations</a></li></ul></li><li><span class="tocitem">type_handling</span><ul><li><a class="tocitem" href="../../type_handling/02-uncertainties/">Numbers with Uncertainties</a></li><li><a class="tocitem" href="../../type_handling/03-unitful/">Unit Checked Arithmetic via Unitful.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">introduction</a></li><li class="is-active"><a href>Formatting Plots</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Formatting Plots</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/SciMLTutorialsOutput/blob/main/docs/src/introduction/05-formatting_plots.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Formatting-Plots"><a class="docs-heading-anchor" href="#Formatting-Plots">Formatting Plots</a><a id="Formatting-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Formatting-Plots" title="Permalink"></a></h1><p>Since the plotting functionality is implemented as a recipe to Plots.jl, <a href="https://juliaplots.github.io/supported/">all of the options open to Plots.jl can be used in our plots</a>. In addition, there are special features specifically for <a href="https://docs.sciml.ai/dev/basics/plot/">differential equation plots</a>. This tutorial will teach some of the most commonly used options. Let&#39;s first get the solution to some ODE. Here I will use one of the Lorenz ordinary differential equation. As with all commands in DifferentialEquations.jl, I got a plot of the solution by calling <code>solve</code> on the problem, and <code>plot</code> on the solution:</p><pre><code class="language-julia hljs">
using DifferentialEquations, Plots, ParameterizedFunctions
gr()
lorenz = @ode_def Lorenz begin
  dx = σ*(y-x)
  dy = ρ*x-y-x*z
  dz = x*y-β*z
end σ β ρ

p = [10.0,8/3,28]
u0 = [1., 5., 10.]
tspan = (0., 100.)
prob = ODEProblem(lorenz, u0, tspan, p)
sol = solve(prob)</code></pre><pre><code class="nohighlight hljs">retcode: Success
Interpolation: automatic order switching interpolation
t: 1341-element Array{Float64,1}:
   0.0
   0.0354861341350177
   0.060663987304508726
   0.10188870843348657
   0.1448498679508511
   0.19835698662820245
   0.2504996228815297
   0.3056774805827286
   0.35452829390108126
   0.40770996764610945
   ⋮
  99.40191484990574
  99.47703618501833
  99.5658234308723
  99.64807844262198
  99.72393302893481
  99.80148021054468
  99.87335069245553
  99.95168876649775
 100.0
u: 1341-element Array{Array{Float64,1},1}:
 [1.0, 5.0, 10.0]
 [2.3156522358261684, 5.897559436807755, 9.406792559102836]
 [3.237795350433643, 7.041031570475972, 9.233678311348145]
 [4.993868184294177, 9.832941470623643, 9.626109614367385]
 [7.42118455058636, 13.9492707343288, 11.582332131961147]
 [11.459763300544093, 19.75311392425321, 18.104295519177246]
 [15.47610807576506, 21.51087067675479, 29.88726710651812]
 [16.447464107891538, 13.124038426772515, 40.97121918674208]
 [12.877766779212395, 2.6188678957805847, 41.25247282418837]
 [7.136964977854118, -3.093417466070861, 35.505128642604284]
 ⋮
 [4.7078175125017845, 7.13104508677844, 18.651036529533698]
 [6.95971825488835, 10.593018553812076, 18.7863316112588]
 [10.646351699805901, 14.856180479322331, 23.998423289322353]
 [12.889615395081899, 13.273612975413583, 32.38413265349776]
 [11.146319066255193, 6.620076861975365, 34.91435700264157]
 [7.21823680615282, 2.4325891343715225, 31.07382292211859]
 [4.528555141302391, 1.9195182135779243, 26.403651898710038]
 [3.35872786591478, 2.855562241006029, 22.042971594934365]
 [3.3579402595045926, 3.829807498655525, 19.879219936458707]</code></pre><pre><code class="language-julia hljs">
plot(sol)</code></pre><p><img src="../figures/05-formatting_plots_2_1.png" alt/></p><p>Now let&#39;s change it to a phase plot. As discussed in the <a href="https://docs.sciml.ai/dev/basics/plot/">plot functions page</a>, we can use the <code>vars</code> command to choose the variables to plot. Let&#39;s plot variable <code>x</code> vs variable <code>y</code> vs variable <code>z</code>:</p><pre><code class="language-julia hljs">
plot(sol,vars=(1, 2, 3))</code></pre><p><img src="../figures/05-formatting_plots_3_1.png" alt/></p><p>We can also choose to plot the timeseries for a single variable:</p><pre><code class="language-julia hljs">
plot(sol,vars=[:x])</code></pre><p><img src="../figures/05-formatting_plots_4_1.png" alt/></p><p>Notice that we were able to use the variable names because we had defined the problem with the macro. But in general, we can use the indices. The previous plots would be:</p><pre><code class="language-julia hljs">
plot(sol,vars=(1,2,3))
plot(sol,vars=[1])</code></pre><p><img src="../figures/05-formatting_plots_5_1.png" alt/></p><p>Common options are to add titles, axis, and labels. For example:</p><pre><code class="language-julia hljs">
plot(sol,linewidth=5,title=&quot;Solution to the linear ODE with a thick line&quot;,
xaxis=&quot;Time (t)&quot;,yaxis=&quot;u(t) (in mm)&quot;,label=[&quot;X&quot;,&quot;Y&quot;,&quot;Z&quot;])</code></pre><p><img src="../figures/05-formatting_plots_6_1.png" alt/></p><p>Notice that series recipes apply to the solution type as well. For example, we can use a scatter plot on the timeseries:</p><pre><code class="language-julia hljs">
scatter(sol,vars=[:x])</code></pre><p><img src="../figures/05-formatting_plots_7_1.png" alt/></p><p>This shows that the recipe is using the interpolation to smooth the plot. It becomes abundantly clear when we turn it off using <code>denseplot=false</code>:</p><pre><code class="language-julia hljs">
plot(sol,vars=(1,2,3),denseplot=false)</code></pre><p><img src="../figures/05-formatting_plots_8_1.png" alt/></p><p>When this is done, only the values the timestep hits are plotted. Using the interpolation usually results in a much nicer looking plot so it&#39;s recommended, and since the interpolations have similar orders to the numerical methods, their results are trustworthy on the full interval. We can control the number of points used in the interpolation&#39;s plot using the <code>plotdensity</code> command:</p><pre><code class="language-julia hljs">
plot(sol,vars=(1,2,3),plotdensity=100)</code></pre><p><img src="../figures/05-formatting_plots_9_1.png" alt/></p><p>That&#39;s plotting the entire solution using 100 points spaced evenly in time.</p><pre><code class="language-julia hljs">
plot(sol,vars=(1,2,3),plotdensity=10000)</code></pre><p><img src="../figures/05-formatting_plots_10_1.png" alt/></p><p>That&#39;s more like it! By default it uses <code>100*length(sol)</code>, where the length is the number of internal steps it had to take. This heuristic usually does well, but unusually difficult equations it can be relaxed (since it will take small steps), and for equations with events / discontinuities raising the plot density can help resolve the discontinuity.</p><p>Lastly notice that we can compose plots. Let&#39;s show where the 100 points are using a scatter plot:</p><pre><code class="language-julia hljs">
plot(sol,vars=(1,2,3))
scatter!(sol,vars=(1,2,3),plotdensity=100)</code></pre><p><img src="../figures/05-formatting_plots_11_1.png" alt/></p><p>We can instead work with an explicit plot object. This form can be better for building a complex plot in a loop.</p><pre><code class="language-julia hljs">
p = plot(sol,vars=(1,2,3))
scatter!(p,sol,vars=(1,2,3),plotdensity=100)
title!(&quot;I added a title&quot;)</code></pre><p><img src="../figures/05-formatting_plots_12_1.png" alt/></p><p>You can do all sorts of things. Have fun!</p><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><p>This tutorial is part of the SciMLTutorials.jl repository, found at: <a href="https://github.com/SciML/SciMLTutorials.jl">https://github.com/SciML/SciMLTutorials.jl</a>.  For more information on doing scientific machine learning (SciML) with open source software, check out <a href="https://sciml.ai/">https://sciml.ai/</a>.</p><p>To locally run this tutorial, do the following commands:</p><pre><code class="nohighlight hljs">using SciMLTutorials
SciMLTutorials.weave_file(&quot;introduction&quot;,&quot;05-formatting_plots.jmd&quot;)</code></pre><p>Computer Information:</p><pre><code class="nohighlight hljs">Julia Version 1.4.2
Commit 44fa15b150* (2020-05-23 18:35 UTC)
Platform Info:
  OS: Linux (x86_64-pc-linux-gnu)
  CPU: Intel(R) Core(TM) i7-9700K CPU @ 3.60GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-8.0.1 (ORCJIT, skylake)
Environment:
  JULIA_LOAD_PATH = /builds/JuliaGPU/DiffEqTutorials.jl:
  JULIA_DEPOT_PATH = /builds/JuliaGPU/DiffEqTutorials.jl/.julia
  JULIA_CUDA_MEMORY_LIMIT = 2147483648
  JULIA_NUM_THREADS = 8
</code></pre><p>Package Information:</p><pre><code class="nohighlight hljs">Status `/builds/JuliaGPU/DiffEqTutorials.jl/tutorials/introduction/Project.toml`
[6e4b80f9-dd63-53aa-95a3-0cdb28fa8baf] BenchmarkTools 0.5.0
[0c46a032-eb83-5123-abaf-570d42b7fbaa] DifferentialEquations 6.15.0
[65888b18-ceab-5e60-b2b9-181511a3b968] ParameterizedFunctions 5.6.0
[91a5bcdd-55d7-5caf-9e0b-520d859cae80] Plots 1.6.3
[90137ffa-7385-5640-81b9-e52037218182] StaticArrays 0.12.4
[c3572dad-4567-51f8-b174-8c6c989267f4] Sundials 4.3.0
[37e2e46d-f89d-539d-b4ee-838fcccc9c8e] LinearAlgebra</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../04-callbacks_and_events/">« Callbacks and Events</a><a class="docs-footer-nextpage" href="../../jumps/spatial/">Ilin »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 13 August 2022 03:52">Saturday 13 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
